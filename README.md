# 🎥📺 AdFunced-bilibili-capture

**通用视频截图工具**

~~项目名称是历史遗留问题~~

~~鉴于 A 站 B 站并没有什么海外业务，这个 README 就不用英文写了。~~

## 📃 安装

[点击此处](https://github.com/Dwscdv3/AdFunced-bilibili-capture/raw/master/AdFunced-bilibili-capture.user.js)。

您的浏览器需要安装有 Greasemonkey 或与其兼容的用户脚本管理器扩展（如 [Tampermonkey](https://www.tampermonkey.net/)），否则将看到源代码而不是安装界面。

使用前请先查看下方的 [使用指南](#-使用指南)。

## 🛠 功能

* 截图
  * 匹配源视频分辨率
  * 快速复制到剪贴板
  * 输出为 PNG 或不同质量的 JPEG
* 录制 GIF
  * 支持自定义分辨率、FPS 等参数
  * 不限时长，~~只要你的内存没爆~~
* ~~人形 TAS~~，单帧操作

## ❔ 使用指南

目前只支持快捷键操作，没有支持 GUI 的打算。~~当然，欢迎 PR（~~

| 快捷键    | 功能                                                                                        |
|:---------:|---------------------------------------------------------------------------------------------|
| A         | 上一帧                                                                                      |
| D         | 下一帧                                                                                      |
| Ctrl+C    | 复制到剪贴板                                                                                |
| S         | 复制到剪贴板并保存到下载目录                                                                |
| Z         | 标记录制起始位置（在进度条上显示标记）                                                      |
| X         | 将从标记处起到当前位置为止的内容录制为 GIF，在新标签页中打开                                |
| Ctrl+Menu | 打开设置面板（输出质量）（Menu 键是空格键右边那个阿卡林附体的 ≣ 键）                        |

截图不会将视频覆盖层（比如进度条、弹幕）截进去，无论其当前是否可见。

截图的分辨率为视频的原始分辨率，不受播放器视窗大小的影响。

复制到剪贴板中的是无损的位图，不受 JPEG 质量参数的影响。GIF 无法复制到剪贴板。

文件名格式为 `视频ID-分钟-秒钟`，例如 `BV1rE411W7m6-21-09.png` `aa5022161-00-41.jpg`。

## ⚠ 兼容性

| 功能     | 浏览器版本  |
|----------|------------|
| 剪贴板   | Chrome 76+ |
| 帧率检测 | Chrome 83+ |

## 🕳 剩下的坑

按优先级排列。~~看心情，不保证会填。~~

* 通过 MediaStream Recording API 录制视频
* 选项：允许在播放时实时录制 GIF，而不是暂停后一帧一帧调进度（数倍的性能提升，但是可能导致轻微丢帧和时间不精确）
* 自定义快捷键
* 美化设置面板

## ❤ 项目依赖

* [gif.js](https://github.com/jnordberg/gif.js)
* [GM_config](https://github.com/sizzlemctwizzle/GM_config)
* [pica](https://github.com/nodeca/pica)
